Timing is important -- huge printf for calibration data causes negotiation to fail (unless redirected to tee or something)

CeivMode::UpdateTemplateListStorageOnFlash:
    CeivMode::GetEnrolledUserList:
    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 4b03000000
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 4a050003004c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    <<< 00000500010000004c000600f50003005809030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

    CeivMode::GetEnrolledUserFingersStorageOnFlash:
    >>> 4b00000b00
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 4a000003004c00030000001c000000010500000000000515000000c5698517bcff12e72496b762ec0300000000000000000000000000000000000000000000000000000
    <<< 00000500010000004c000600f50003005809030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 4a000003004c00030000001c000000010500000000000515000000c5698517bcff12e72496b762ec0300000000000000000000000000000000000000000000000000000
    <<< 00000500010000004c000600f50003005809030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

CeivMode::ValidateDatabase:
    // (gets MachineGuid from registry)
    CeivMode::GetCommonDataStorageOnFlash (get size):
    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 460300
    <<< 00000300040003001b00020000000400080005000500

    >>> 490400
    <<< 00000400080003009800000002019400650037003200360030003800370036002d0035003800640062002d0034006400320037002d0038006300340030002d0038006400310033003100310030006400360061003700320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                                    ^^^^ size

    (returns 80070074 = not enough room in output buffer)

    CeivMode::GetCommonDataStorageOnFlash (2nd attempt - with allocated buffer):
    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

CeivMode::UpdateTemplateListStorageOnFlash:
    CeivMode::GetEnrolledUserList:
    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 4b03000000
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 4a050003004c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    <<< 00000500010000004c000600f50003005809030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

    CeivMode::GetEnrolledUserFingersStorageOnFlash:
    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 4a000003004c00030000001c000000010500000000000515000000c5698517bcff12e72496b762ec0300000000000000000000000000000000000000000000000000000
    <<< 00000500010000004c000600f50003005809030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 4a000003004c00030000001c000000010500000000000515000000c5698517bcff12e72496b762ec0300000000000000000000000000000000000000000000000000000
    <<< 00000500010000004c000600f50003005809030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

CBiometricDevice::GetPBAAndSSODataFromFlash:
    CeivMode::GetCommonDataStorageOnFlash:
    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 460300
    <<< 00000300040003001b00020000000400080005000500

    >>> 490400
    <<< 00000400080003009800000002019400650037003200360030003800370036002d0035003800640062002d0034006400320037002d0038006300340030002d0038006400310033003100310030006400360061003700320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

    (returns 80070073)

    CeivMode::GetCommonDataStorageOnFlash (try 2):
    >>> 4b00000b0053746757696e64736f7200
    <<< 0000030001000b00000005004c0053746757696e64736f7200

    >>> 460300
    <<< 00000300040003001b00020000000400080005000500

    >>> 490400
    <<< 00000400080003009800000002019400650037003200360030003800370036002d0035003800640062002d0034006400320037002d0038006300340030002d0038006400310033003100310030006400360061003700320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

    (returns 80070073)

CBiometricDriver::OnDeinitialize:
>>> 0100c004b72282755be04bf04196136f8048b3b0ec102444752694bcd7dc1392dc9d0d0d0d0d0d0d0d0d0d0d0d0d0d0d
<<< 01003fbc118b60c53cfa34413c1352aa11fc4f5971bd1387a132aebdb854c2ba27930d0d0d0d0d0d0d0d0d0d0d0d0d0d

-----------------------------------------
scan:
440014 - start scan

442004 - IdentifyFeatureSet, result size either 0x888 or 0x1890.
0x1890: 0x1008 of something else then - the same as in 0x888:

0x888:
CPBAIdentificationImpl::GetResults:
    +0x00 (size=0x4c) - WINBIO_IDENTITY
    +0x4c (1 byte, not 0 and not ff), - PWINBIO_BIOMETRIC_SUBTYPE (f7(5) - WINBIO_FINGER_UNSPECIFIED_POS_03(01))
    +0x54 (size=0x20)
+0x50: rc = CeivMode::IdentifyUserStorageOnFlash()
+0x80 (size 0x800) var_F7 (var_FF) in 
....

44200C - EngineAdapterCreateEnrollment (input ptr to dword 1 (size=4) - hardcoded, no output)
442010 - EngineAdapterUpdateEnrollment (no input, =2c bytes output)
442014 - CheckForDuplicate (no input?, =50 bytes output)
442018 - StorageAdapterAddRecord (in payload size + 0x5f, out - 1 byte)
442034 - StorageAdapterDeleteRecord
0x00 0x4c - Identity
0x4c 0x01 - SubFactor
0x50 0x08 - Payload Size
0x58 XXXX - Payload

--------------------------
7 iterations:
------------------------- 1st iteration -------------------------
CLedImpl::glow:
>>> 3920bf0200ffff0000019900200000000099990000000000000000000000000020000000000000000000000000ffff000000990020000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< 0000
CLedImpl::glow - end.

StartCapture:
>>> 02980000002300000020000800002000800000010032007000000000802020050024200000502077362820010030200100082170000c210000482102004c210000582000005c20000060200000682005006c20012970200121742001887820018084202000942001809c200902a0200b19b4200000b8203b04bc201400c0200200c4200100c82002003300100000000080cc200000f503d0200000a1013200440000000080dc20e803e0206401e420d002e8200001f0200500f8200500fc200000b8203b00000804001408000008080000080800001408300008080000140831001c081a0032000c0000000080501101004c1126003400080310071d10071d10071d10071d10071c01065810080101000007c8078c06100000204f80007f000003070107010c07032c08fc80095a800afc08fb800b5a095b800afb08fa800b5b095c800afa08f9800b5c095d800af908f8800b5d095e800af808f7800b5e095f800af708f6800b5f0960800af608f5800b600961800af508f4800b610962800af408f3800b620963800af308f2800b630964800af208f1800b640965800af108f0800b650966800af008ef800b660967800aef08ee800b670968800aee08ed800b68096c800aed08ec800b6c096d800aec08eb800b6d096e800aeb08ea800b6e096f800aea08e9800b6f0970800ae908e8800b700971800ae808e7800b710972800ae708e6800b720973800ae608e5800b730974800ae508e4800b740975800ae408e3800b750976800ae308e2800b760977800ae208e1800b770978800ae108e0800b780979800ae008df800b79097a800adf08de800b7a097b800ade08dd800b7b097c800add08dc800b7c097d800adc08db800b7d097e800adb08da800b7e097f800ada08d9800b7f0980800ad908d8800b800981800ad808d7800b810982800ad708d6800b820983800ad608d5800b830984800ad508d4800b840985800ad408d3800b850986800ad308d2800b860987800ad208d1800b870988800ad108d0800b880989800ad008cf800b89098a800acf08ce800b8a098b800ace08cd800b8b098c800acd08cc800b8c098d800acc08cb800b8d098e800acb08ca800b8e098f800aca08c9800b8f0990800ac908c8800b900991800ac808c7800b910992800ac708c6800b920993800ac608c5800b930994800ac508c4800b940995800ac408c3800b950996800ac308c2800b960997800ac208c1800b970998800ac108c0800b980999800ac008bf800b99099a800abf08be800b9a099b800abe08bd800b9b099c800abd08bc800b9c099d800abc08bb800b9d099e800abb08ba800b9e099f800aba08b9800b9f09a0800ab908b8800ba00801800ab808b7800a010802800ab708b6800a020803800ab608b5800a030804802003070404020000000000002f00040090000000290004000000000035000400100000001700000026002800fbb20f00f2220f00300000006001020040010a00018000000a0200000b19000050c360ea010910002e001c000200180023000000900090004d01000090017c013c323232640a02013000cc0103000000ff0000001d000003ff00000025000003ff00000022000003101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9f2b23203c2d182e1e30182e1c321d341d341e321c301e1e241e201f201d1c321a301e1c211e21341f1e202024201f1e20201f212221221d221e23341e1d1e1d20341f1d193b341c1d1e35201e201c20221f341c1e1e1c221f201d21201e1c1f34242221201f20221f201e241e241d2020221e2420231d221e211e1f1e1e341c321e3220301d2d302f2d2c2b23223a211c7e7f807f808080808080808080808080808080808080818081808180818080808080818081808080818081808180818081808180818081808180808081808180808081807f80808180808081808180818080808180818081808180818081808080818081808180818081808180818081808180818081808180818081808080808080808080807f807f807f807f7f7e7e
??? enroll='02980000002300000020000800002000800000010032007000000000802020050024200000502077362820010030200100082170000c210000482102004c210000582000005c20000060200000682005006c20012970200121742001887820018084202000942001809c200902a0200b19b4200000b8203b04bc201400c0200200c4200100c82002003300100000000080cc200000f503d0200000a1013200440000000080dc20e803e0206401e420d002e8200001f0200500f8200500fc200000b8203b00000804001408000008080000080800001408300008080000140831001c081a0032000c0000000080501101004c1126003400080310071d10071d10071d10071d10071c01065810080101000007c8078c06100000204f80007f000003070107010c07032c08fc80095a800afc08fb800b5a095b800afb08fa800b5b095c800afa08f9800b5c095d800af908f8800b5d095e800af808f7800b5e095f800af708f6800b5f0960800af608f5800b600961800af508f4800b610962800af408f3800b620963800af308f2800b630964800af208f1800b640965800af108f0800b650966800af008ef800b660967800aef08ee800b670968800aee08ed800b68096c800aed08ec800b6c096d800aec08eb800b6d096e800aeb08ea800b6e096f800aea08e9800b6f0970800ae908e8800b700971800ae808e7800b710972800ae708e6800b720973800ae608e5800b730974800ae508e4800b740975800ae408e3800b750976800ae308e2800b760977800ae208e1800b770978800ae108e0800b780979800ae008df800b79097a800adf08de800b7a097b800ade08dd800b7b097c800add08dc800b7c097d800adc08db800b7d097e800adb08da800b7e097f800ada08d9800b7f0980800ad908d8800b800981800ad808d7800b810982800ad708d6800b820983800ad608d5800b830984800ad508d4800b840985800ad408d3800b850986800ad308d2800b860987800ad208d1800b870988800ad108d0800b880989800ad008cf800b89098a800acf08ce800b8a098b800ace08cd800b8b098c800acd08cc800b8c098d800acc08cb800b8d098e800acb08ca800b8e098f800aca08c9800b8f0990800ac908c8800b900991800ac808c7800b910992800ac708c6800b920993800ac608c5800b930994800ac508c4800b940995800ac408c3800b950996800ac308c2800b960997800ac208c1800b970998800ac108c0800b980999800ac008bf800b99099a800abf08be800b9a099b800abe08bd800b9b099c800abd08bc800b9c099d800abc08bb800b9d099e800abb08ba800b9e099f800aba08b9800b9f09a0800ab908b8800ba00801800ab808b7800a010802800ab708b6800a020803800ab608b5800a030804802003070404020000000000002f00040090000000290004000000000035000400100000001700000026002800fbb20f00f2220f00300000006001020040010a00018000000a0200000b19000050c360ea010910002e001c000200180023000000900090004d01000090017c013c323232640a02013000cc0103000000ff0000001d000003ff00000025000003ff00000022000003101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9f2b23203c2d182e1e30182e1c321d341d341e321c301e1e241e201f201d1c321a301e1c211e21341f1e202024201f1e20201f212221221d221e23341e1d1e1d20341f1d193b341c1d1e35201e201c20221f341c1e1e1c221f201d21201e1c1f34242221201f20221f201e241e241d2020221e2420231d221e211e1f1e1e341c321e3220301d2d302f2d2c2b23223a211c7e7f807f808080808080808080808080808080808080818081808180818080808080818081808080818081808180818081808180818081808180808081808180808081807f80808180808081808180818080808180818081808180818081808080818081808180818081808180818081808180818081808180818081808080808080808080807f807f807f807f7f7e7e'
??? ident='02980000002300000020000800002000800000010032007000000000802020050024200000502077362820010030200100082170000c210000482102004c210000582000005c20000060200000682005006c20012970200121742001887820018084202000942001809c200902a0200b19b4200000b8203b04bc201400c0200200c4200100c82002003300100000000080cc200000f503d0200000a1013200440000000080dc20e803e0206401e420d002e8200001f0200500f8200500fc200000b8203b00000804001408000008080000080800001408300008080000140831001c081a0032000c0000000080501101004c1126003400080310071d10071d10071d10071d10071c01065810080101000007c8078c06100000204f80007f000003070107010c07032c08fc80095a800afc08fb800b5a095b800afb08fa800b5b095c800afa08f9800b5c095d800af908f8800b5d095e800af808f7800b5e095f800af708f6800b5f0960800af608f5800b600961800af508f4800b610962800af408f3800b620963800af308f2800b630964800af208f1800b640965800af108f0800b650966800af008ef800b660967800aef08ee800b670968800aee08ed800b68096c800aed08ec800b6c096d800aec08eb800b6d096e800aeb08ea800b6e096f800aea08e9800b6f0970800ae908e8800b700971800ae808e7800b710972800ae708e6800b720973800ae608e5800b730974800ae508e4800b740975800ae408e3800b750976800ae308e2800b760977800ae208e1800b770978800ae108e0800b780979800ae008df800b79097a800adf08de800b7a097b800ade08dd800b7b097c800add08dc800b7c097d800adc08db800b7d097e800adb08da800b7e097f800ada08d9800b7f0980800ad908d8800b800981800ad808d7800b810982800ad708d6800b820983800ad608d5800b830984800ad508d4800b840985800ad408d3800b850986800ad308d2800b860987800ad208d1800b870988800ad108d0800b880989800ad008cf800b89098a800acf08ce800b8a098b800ace08cd800b8b098c800acd08cc800b8c098d800acc08cb800b8d098e800acb08ca800b8e098f800aca08c9800b8f0990800ac908c8800b900991800ac808c7800b910992800ac708c6800b920993800ac608c5800b930994800ac508c4800b940995800ac408c3800b950996800ac308c2800b960997800ac208c1800b970998800ac108c0800b980999800ac008bf800b99099a800abf08be800b9a099b800abe08bd800b9b099c800abd08bc800b9c099d800abc08bb800b9d099e800abb08ba800b9e099f800aba08b9800b9f09a0800ab908b8800ba00801800ab808b7800a010802800ab708b6800a020803800ab608b5800a030804802003070404020000000000002f00040090000000290004000000000035000400100000001700000026002800fbb20f00f2220f00300000006001020040010a00018000000a0200000b19000050c360ea010910002e001c000200180002000000900090004d01000090017c013c323232640a02013000cc0103000000ff0000001d000003ff00000025000003ff00000022000003101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9f2b23203c2d182e1e30182e1c321d341d341e321c301e1e241e201f201d1c321a301e1c211e21341f1e202024201f1e20201f212221221d221e23341e1d1e1d20341f1d193b341c1d1e35201e201c20221f341c1e1e1c221f201d21201e1c1f34242221201f20221f201e241e241d2020221e2420231d221e211e1f1e1e341c321e3220301d2d302f2d2c2b23223a211c7e7f807f808080808080808080808080808080808080818081808180818080808080818081808080818081808180818081808180818081808180808081808180808081807f80808180808081808180818080808180818081808180818081808080818081808180818081808180818081808180818081808180818081808080808080808080807f807f807f807f7f7e7e'
??? Diff at offset 0x451: enroll=23, ident=02

<<< 000088020030c200000010071d10071d10071d10071d10071c01065810080101000007c8078c06100000204f80007f000003070107010c07032c08fc80095a800afc08fb800b5a095b800afb08fa800b5b095c800afa08f9800b5c095d800af908f8800b5d095e800af808f7800b5e095f800af708f6800b5f0960800af608f5800b600961800af508f4800b610962800af408f3800b620963800af308f2800b630964800af208f1800b640965800af108f0800b650966800af008ef800b660967800aef08ee800b670968800aee08ed800b68096c800aed08ec800b6c096d800aec08eb800b6d096e800aeb08ea800b6e096f800aea08e9800b6f0970800ae908e8800b700971800ae808e7800b710972800ae708e6800b720973800ae608e5800b730974800ae508e4800b740975800ae408e3800b750976800ae308e2800b760977800ae208e1800b770978800ae108e0800b780979800ae008df800b79097a800adf08de800b7a097b800ade08dd800b7b097c800add08dc800b7c097d800adc08db800b7d097e800adb08da800b7e097f800ada08d9800b7f0980800ad908d8800b800981800ad808d7800b810982800ad708d6800b820983800ad608d5800b830984800ad508d4800b840985800ad408d3800b850986800ad308d2800b860987800ad208d1800b870988800ad108d0800b880989800ad008cf800b89098a800acf08ce800b8a098b800ace08cd800b8b098c800acd08cc800b8c098d800acc08cb800b8d098e800acb08ca800b8e098f800aca08c9800b8f0990800ac908c8800b900991800ac808c7800b910992800ac708c6800b920993800ac608c5800b930994800ac508c4800b940995800ac408c3800b950996800ac308c2800b960997800ac208c1800b970998800ac108c0800b980999800ac008bf800b99099a800abf08be800b9a099b800abe08bd800b9b099c800abd08bc800b9c099d800abc08bb800b9d099e800abb08ba800b9e099f800aba08b9800b9f09a0800ab908b8800ba00801800ab808b7800a010802800ab708b6800a020803800ab608b5800a0308048020030704040200000000000090020030000000000000000000000000000000000000000002000000280200001c02000040000000c604000000000000020000000000000000000000380000000200000008000000a0120000c0120000a4120000c012000000000000000000000000000002000000080800004d0800004d08000000000000000000002f000000a31d0000a04d000018240000000000001200000000000000201e0000d03b00000100000000000000501f0000501f0000b81e0000b81e0000201e0000201e0000201e000000000000000000000200000000000000a81200000000000000000000000000000200000000000000b01200000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000c800000018000000695a7ea5000000000704000000004101ca120f00a8160f000000000000000000000000000000000000000000040200000c000000200d33330300000000000000ff000000000000000200130071c3000000000000c3000000000000000000000000000000695a7ea50a000000000000000000000000000000a000ffff050000000000000000000000100000000100000031000000040000001a00000000000000e001000000000000090000000000000000000000949b020024c902008c5e0200ac620200685c0200f01c0200afd90100afbc0100fda40100acdb01003f8e0000eefa0100af2d0100efbf01005dff0000f8db0000b2690100f89f0100ff2701004b7d0000af8b010027b7000028520100ff780000fd7601004c7a0100fbf10100efd80000f7de0100ba770100ff0e010089bf010063fb0100fffb0100f72e0100e7da0100f7a600007de70100e7030000cff7010006a1d6410634cbbd06d1e50c06c0e4100648e60c061df6a11f6f27dbf2345c2ac57abf625f0959fe7be4f9e52f635192e4faffcfafbdbd77ffd3d147eb2b29f52ffd95e96b63154fbfdee0958b97fecbe5116dbe10f97ddbaddc99469effa176f9cb2f66dcffb326fa5ae7fafab5751f752bfcfecfae267aaf637c11de7ffb6e7f793fbcfbdfcbde5ff9d9fcfa3bcbe9ffd7f2dcf29ffcc5bcd7bbaf73e494370000000000000000000000000000000000000000010000000100000076040000e8670000ff07000003000000010000000f000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000988000000000000000000000260000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000980100192800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000009900000000000000990000000000000000000000ff030000000000000000000000000000000000000000010010000000030000000100000003000000000000400300000001000000050000000000ff00010000000000000001000000000000000000000000000000000000000000000000000000000000007736000000000000000000000000000000000000000000000500000001290000012100000188000001800000000000000000000030000000000000006001020040010a0001800000004002000a0200000b19000000000000000000000000000000000000000000003b000000140000000200000001000000020000000000f5030000a101effc0f0000000000e803000064010000d002000000010000000000000500000000000000050000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000

CCaptureImage::WaitForFinger:
!!! 00 00 00 00 00

// Finger placed:
!!! 02 00 40 10 00
CCaptureImage::WaitForFinger - end.

>>> 5100000000
<<< 010000000000

>>> 5100000000
<<< 060000000000

>>> 5100000000
<<< 020000000000

...

>>> 5100000000
<<< 020000000000

>>> 5100000000
<<< 000000000000

>>> 5100200000
<<< 00000c000000900090004d01080000000000

!!! 03 43 04 00 41
StartCapture -- end.

CEocMocEIV::EnrollmentUpdate:
>>> 680000000000000000
<<< 0000a325f75e

!!! 03 00 00 00 db
>>> 6b
<<< 0000

!!! 05 00 00 00 db
>>> 6b
<<< 00002402 0100340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000920100000e0000000000000042000000000000000000000000000000000000000000000000000000ffffffff000000002a000000 0000800100000000f175a89....<template>

>>> 6900000000
<<< 0000
CEocMocEIV::EnrollmentUpdate - end. Returns 0100090000000000000000000000000000000000000000000000000000000000000000000e00000000000000 (0e - progress, 14% done).

------------------------- 2nd iteration -------------------------
CLedImpl::glow:
>>> (same) 3920bf0200ffff0000019900200000000099990000000000000000000000000020000000000000000000000000ffff000000990020000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< 0000
CLedImpl::glow - end

StartCapture:
>>> (same) 02980000002300000020000800002000800000010032007000000000802020050024200000502077362820010030200100082170000c210000482102004c210000582000005c20000060200000682005006c20012970200121742001887820018084202000942001809c200902a0200b19b4200000b8203b04bc201400c0200200c4200100c82002003300100000000080cc200000f503d0200000a1013200440000000080dc20e803e0206401e420d002e8200001f0200500f8200500fc200000b8203b00000804001408000008080000080800001408300008080000140831001c081a0032000c0000000080501101004c1126003400080310071d10071d10071d10071d10071c01065810080101000007c8078c06100000204f80007f000003070107010c07032c08fc80095a800afc08fb800b5a095b800afb08fa800b5b095c800afa08f9800b5c095d800af908f8800b5d095e800af808f7800b5e095f800af708f6800b5f0960800af608f5800b600961800af508f4800b610962800af408f3800b620963800af308f2800b630964800af208f1800b640965800af108f0800b650966800af008ef800b660967800aef08ee800b670968800aee08ed800b68096c800aed08ec800b6c096d800aec08eb800b6d096e800aeb08ea800b6e096f800aea08e9800b6f0970800ae908e8800b700971800ae808e7800b710972800ae708e6800b720973800ae608e5800b730974800ae508e4800b740975800ae408e3800b750976800ae308e2800b760977800ae208e1800b770978800ae108e0800b780979800ae008df800b79097a800adf08de800b7a097b800ade08dd800b7b097c800add08dc800b7c097d800adc08db800b7d097e800adb08da800b7e097f800ada08d9800b7f0980800ad908d8800b800981800ad808d7800b810982800ad708d6800b820983800ad608d5800b830984800ad508d4800b840985800ad408d3800b850986800ad308d2800b860987800ad208d1800b870988800ad108d0800b880989800ad008cf800b89098a800acf08ce800b8a098b800ace08cd800b8b098c800acd08cc800b8c098d800acc08cb800b8d098e800acb08ca800b8e098f800aca08c9800b8f0990800ac908c8800b900991800ac808c7800b910992800ac708c6800b920993800ac608c5800b930994800ac508c4800b940995800ac408c3800b950996800ac308c2800b960997800ac208c1800b970998800ac108c0800b980999800ac008bf800b99099a800abf08be800b9a099b800abe08bd800b9b099c800abd08bc800b9c099d800abc08bb800b9d099e800abb08ba800b9e099f800aba08b9800b9f09a0800ab908b8800ba00801800ab808b7800a010802800ab708b6800a020803800ab608b5800a030804802003070404020000000000002f00040090000000290004000000000035000400100000001700000026002800fbb20f00f2220f00300000006001020040010a00018000000a0200000b19000050c360ea010910002e001c000200180023000000900090004d01000090017c013c323232640a02013000cc0103000000ff0000001d000003ff00000025000003ff00000022000003101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9f2b23203c2d182e1e30182e1c321d341d341e321c301e1e241e201f201d1c321a301e1c211e21341f1e202024201f1e20201f212221221d221e23341e1d1e1d20341f1d193b341c1d1e35201e201c20221f341c1e1e1c221f201d21201e1c1f34242221201f20221f201e241e241d2020221e2420231d221e211e1f1e1e341c321e3220301d2d302f2d2c2b23223a211c7e7f807f808080808080808080808080808080808080818081808180818080808080818081808080818081808180818081808180818081808180808081808180808081807f80808180808081808180818080808180818081808180818081808080818081808180818081808180818081808180818081808180818081808080808080808080807f807f807f807f7f7e7e
<<< (different) 000088020030c200000010071d10071d10071d10071d10071c01065810080101000007c8078c06100000204f80007f000003070107010c07032c08fc80095a800afc08fb800b5a095b800afb08fa800b5b095c800afa08f9800b5c095d800af908f8800b5d095e800af808f7800b5e095f800af708f6800b5f0960800af608f5800b600961800af508f4800b610962800af408f3800b620963800af308f2800b630964800af208f1800b640965800af108f0800b650966800af008ef800b660967800aef08ee800b670968800aee08ed800b68096c800aed08ec800b6c096d800aec08eb800b6d096e800aeb08ea800b6e096f800aea08e9800b6f0970800ae908e8800b700971800ae808e7800b710972800ae708e6800b720973800ae608e5800b730974800ae508e4800b740975800ae408e3800b750976800ae308e2800b760977800ae208e1800b770978800ae108e0800b780979800ae008df800b79097a800adf08de800b7a097b800ade08dd800b7b097c800add08dc800b7c097d800adc08db800b7d097e800adb08da800b7e097f800ada08d9800b7f0980800ad908d8800b800981800ad808d7800b810982800ad708d6800b820983800ad608d5800b830984800ad508d4800b840985800ad408d3800b850986800ad308d2800b860987800ad208d1800b870988800ad108d0800b880989800ad008cf800b89098a800acf08ce800b8a098b800ace08cd800b8b098c800acd08cc800b8c098d800acc08cb800b8d098e800acb08ca800b8e098f800aca08c9800b8f0990800ac908c8800b900991800ac808c7800b910992800ac708c6800b920993800ac608c5800b930994800ac508c4800b940995800ac408c3800b950996800ac308c2800b960997800ac208c1800b970998800ac108c0800b980999800ac008bf800b99099a800abf08be800b9a099b800abe08bd800b9b099c800abd08bc800b9c099d800abc08bb800b9d099e800abb08ba800b9e099f800aba08b9800b9f09a0800ab908b8800ba00801800ab808b7800a010802800ab708b6800a020803800ab608b5800a0308048020030704040200000000000090020030000000000000000000000000000000000000000002000000280200001c020000400000000902000000000000020000000000000000000000380000000200000008000000a0120000c0120000a4120000c012000000000000000000000000000002000000080800004d0800004d08000000000000c00000002f000000a31d0000a04d000018240000200000000000000000000000a00101002057010001000000c02a0000603f0100603f0100c83e0100c83e0100a0010100a0010100603f010000000000000000000200000005000000a8120000b012000000000000000000000200000000000000b01200000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000c800000018000000695a7ea500000000070400000000410193ea1700b6f117000000000000000000000000000000000000000000040200000c000000200d33330300000000000000ff000000000000000200130071c3000000000000c3000000000000000000000000000000695a7ea50a000000000000000000000000000000a000ffff050000000000000000000000100000000100000031000000040000001a00000000000000e001000000000000090000000000000000000000949b020024c902008c5e0200ac620200685c0200f01c0200afd90100afbc0100fda40100acdb01003f8e0000eefa0100af2d0100efbf01005dff0000f8db0000b2690100f89f0100ff2701004b7d0000af8b010027b7000028520100ff780000fd7601004c7a0100fbf10100efd80000f7de0100ba770100ff0e010089bf010063fb0100fffb0100f72e0100e7da0100f7a600007de70100e7030000cff7010006a1d6410634cbbd06d1e50c06c0e4100648e60c061df6a11f6f27dbf2345c2ac57abf625f0959fe7be4f9e52f635192e4faffcfafbdbd77ffd3d147eb2b29f52ffd95e96b63154fbfdee0958b97fecbe5116dbe10f97ddbaddc99469effa176f9cb2f66dcffb326fa5ae7fafab5751f752bfcfecfae267aaf637c11de7ffb6e7f793fbcfbdfcbde5ff9d9fcfa3bcbe9ffd7f2dcf29ffcc5bcd7bbaf73e4943700000000000000000000000000000000000000000100000001000000760400001f520000ff07000003000000010000000f000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000988000000000000000000000260000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000980100192800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000009900000000000000990000000000000000000000ff030000000000000000000000000000000000000000010010000000990f00001c00000069000000000000400300000001000000050000000000ff00010000000000000001000000000000000000000081000000000000000000000000000000000000007736000000000000000000000000000000000000000000000500000001290000012100000188000001800000000000000000000030000000000000006001020040010a0001800000000000000a0200000b19000000000000000000000000000000000000000000003b00000014000000020000000100000002000000f003f5030000a1010000000000000000e803000064010000d002000000010000000000000500000000000000050000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000

CCaptureImage::WaitForFinger:
!!! 00 00 00 00 00

// Finger placed:
!!! 02 00 40 10 00
CCaptureImage::WaitForFinger - end.

>>> 5100000000
<<< 010000000000

>>> 5100000000
<<< 060000000000

>>> 5100000000
<<< 020000000000

...

>>> 5100000000
<<< 020000000000

>>> 5100000000
<<< 000000000000

>>> 5100200000
<<< 00000c000000900090004d01080000000000

!!! 03 43 04 00 41
StartCapture -- end.

CEocMocEIV::EnrollmentUpdate:
>>> 68a325f75e00000000
<<< 0000a325f75e

!!! 03 00 00 00 db
>>> 6b0000800100000000f175a89f3aaa236ff....<template>
<<< 0000

!!! 05 00 00 00 db
>>> 6b0000800100000000f175a89f3aaa236ff6202d6da7ec2c....<template>
<<< 0000d4030100340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000920100001c0000000000000042000000000000000000000000000000000000000000000000000000ffffffff00000000370000000000300300000000e97ee00308c0967885d7e....<updated template>

>>> 6900000000
<<< 0000

--------------------------------
<<< 0000 d403
0100 3400 
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
920100001c0000000000000042000000000000000000000000000000000000000000000000000000ffffffff0000000037000000

0000300300000000
e97ee00308c0967885d7e71141884f26840ed114705d024da911a2abce771261366b516203aa181a5109dc082d1755e8f 01...<final template>...95
d891393fb3c008bf21bfd36d45b2da20348f7dbc9b35d54ad0e2f89ba794e2e831724206df1c3f03cf9a8e5442d512856

last update response
<<< 0000 5c0f
0100 3400 
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90010000640000000000000042000000000000000000000000000000000000000000000000000000ffffffff6400000028000000
0000600e000000000
5e31293ac59d01f06ff8121be2dd7f10fcfe61f5bdcc9e62a83b20c30124a24938cf5de37ee780399460e177b81c759f5
83b89bdd6e0405a...<template>...761ff80811f970e
aaf397334519e4220e27066c4976a669a6a3d2415405f9788ed9ea9a48ae789be4fc75f4e0e7163ffe75b881eafb9f6e8
0300 2000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
c4e991d8727e922415ce736a2fa119d14011be0fbca8c93849fb361d38a06e9e
--------------------------------


CEocMocEIV::EnrollmentUpdate - end. Returns 01000900 0000000000000000000000000000000000000000000000000000000000000000 1c00000000000000

... remaining 5 iterations

Last iteration:
CEocMocEIV::EnrollmentUpdate - end. Returns 00000000 c4e991d8727e922415ce736a2fa119d14011be0fbca8c93849fb361d38a06e9e 6400000000000000


CEocMocEIV::EnrollmentCommit:
lookup storage by key
>>> 4b00000b0053746757696e64736f7200
<<< 0000030000000b00000053746757696e64736f7200

-------------- add user ------------
tx begin?
>>> 45
<<< 00000100000000000000000003000004000000fc0200020001000300

check if the user exists. lookup user by key and the storage id
>>> 4a000003004c00030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< b304 - not found

authorize
>>> 0602000001648445315dac4d9c91edfb3c327ec18aee87a1fd5e0993fe74b56ee9a70f0eb4d65bfc877060728ad26e695be98899ef76b852162cc5e6ccded51e5a26e7e345c4a8e83aafa2e10fa4cc78f0f34575b0565089b4c78ce1ac7fe3744f4721aa73209fa4a8699e7161bfd7ee58dee33f1af15ba3b9ce9a469c5c82eda2b2a2f01658ee14118304e865bc2ad415bec9f06757bb3f2263bd0349a3c089380b72a30edf8db01db75586c60ddc9e7bedc8cf9006fcc6825b0ec9dc8782b95f53325bfb6a6945644f2803a4c7fd35574d8b7b089102fb072dfa883049f9484a789ff763a029f78adfceac92db195573c65986e38aec2135b5da3c0797939154135be5227515602c0148dbcb8c8a3760dad71f877471244cf1053a3cc4bc73c437589a1a47e08c260ea40d3259138e754a556a23e09bf926ad90ff36096c27c460ebdd28f20f31e9f42a192526d79b94e7f2c36b66db69946d93edf8fbd516e3ae59a0b81400c39f6bc1feb209924bc04703fd36ab53dd5658b2dd91633823917c37e944e740409c5fd66974ed42b73d5d7db519c7037b1ed32e471750da95299463cb070c80cea4a03bf20351716ee14423f84670c53ef7b998c179b84ae91cff6ca6b33a372e9947eebc873c6a98c6bcda68e5278b6f799a468bd1a33ae07bf717fbfc20f4d019f0fb25a5d6cb75a97fbd9b8490e6204d272d93f62ad393307cad3e24d292040e61fce6f1104c42dc4260de15f42971bbab18064b5dd6ceb12a32d9d25614d9326048052bc178b5a0aed3f350cbbec021c4b1ac6ed383f7f4eca0e475cf56caefc3edd3cde6526401936cc095b2df8e0008b2d9bd78c82af0a1ec0a71f047dd06b4ce6e91886607c55536f0d8712eae4ccb890008ccc27f2d6f6cb9b9bb88ec205019ec722160ffb1c65ca3177cff09c4bdae8c40be5bf91488a600ed199d0aad40510afe580802c56c0241a8b2a836800e8a0d07ae37176934252f92fc0e501aee29e6c3567e37b3e1992ff00b561fd1b3ae37caecc3a1fea7720b0806d3b39cf8a3fb46087b43775b9e473e65cb18af1c9d87a5140a5edf8b7843524910d63179c436b6a806d100eb066db889768f7da603631d75a6d79e3d0eb1fe9ba55401b828d4a367f695f3922b982be10fdb1f139a0b1438abc911db5da00ed464d80e3086d368dd131985a21610cd485740599afa772b5dc44d1906ea4c13b8e10b8db896fb81b706038a3328cd07aeb049e6ec92ecd30044c54eb171e9cf7a0034cd24614616048491f576826af5ca6afe4bc01f86dc01c2ea25efb32bc9b1c8d56cc7d4d86adf8f1f3bb6a649f98bae686ef93524721c618fad85a8125a8ac7d72bfeb7de9f590e8f43535e59259a7a1d13a12a1af91c8ba0dd45ddad02e5b86224fc00dcbc143b0e1d2da638d6798fcc340bda8f1e3abf21cadb2161c4c4be7001371dc56f0d112b42b113288effea6cab8c4b610f73037643de21f433774d9fb28cfd213a62dcafab8b662b57e77239dc2fb69f026fcb773f09129c8db04b82dce68734516ffcb938d43deeeedaa02cc08d7d06f34ec55ba4b224d3270265001df114b946d4238d51cfbfb84cf715b745ec918259c1165ee12ab82b4373eaa2b0c7e68da3eb869ff033d5953800012bb006d1cf17dcbbe2fb2e129614351c000cab8ccc7c389df33dbe504a0c1df37868b839ef84a6c04072d69fc86633055b2569c9c04f1994758987fc7063b97853c727809185a25cd69bfebf6a4367760fd21e7942b997bb2b7098dbec715769d13413c1c93185409e54a2c9a97daf63114c71348f19549fb3a8551afbbb7476842f7045a0ec8e6d97fb4bb6de76090687ab4e9991a31e7625ba7088a3263797be4787db02573b72100b3ba117e8897b939548715bcfa11d98861b60fa2a4759630b47cbbf329fbc675c4cfc2f963cc9ba72cbe6713aff1851869917ba0b761f6532d1dee95331c4c621bb0513e993f7e6dda6da1e3076829b24093c8338c125aa2f5a0730f9e5631f7a9594c13025fde9bb4f2431540a1c743c7fc55fc8909d85847fe71af8a68d2981b0eee84a308e0160fc4226aa679ca9b35d0aacae8240aabd5b217c5e66ac4795596f8742acb9869c3f52a96b1d946ff72f403ba491c1a0e4be778efab9d61a250562d705c2b459fc3a420143daf93552264bb8c7caa64143697961fab1b6af9e852d43a94736e1e75e4b9a7c2bee73598360c7e4c648e47ba9400dbe22b3eea6d9ab87fe677b3624257f81d26b87536a642a7840bdccd8fce05c23891a4fa4ce2156fba2856313653207bf225b8114005432824d16a93473deb81721c77196afd80cf723e8cdea81aaed19f55a09a8986f2950c49f4eebfb142d5e4815632d93ccb0106c156b47efca25dc3d7f31eb9b2dee0d2d83a51cbe5d1270222920f2c87e5acc884c11b0df7a7e1bb49b06fa4f936964d3f2782fa46eec3e430815f82ab0fb5eb82377277f8fe3ae5b33732d7d76ba3de284c66fba372f04f9ad6a39fa669a00583313d51c8e6b1eb960bf1e82ae8e0504b2d3035b371d5ecf638c1cc0c1dd67eff286fc9ee0950da53f339a85fbbcbacf61fcdadee8cdba0950d23ec71e2239ae7ab5be1bf56364897af990428822d23deed81fbbe622420234ded92b8fc3073bfa0a9677cd9e24b9f81278c50584bdc880fa2cd5c5c4b03bd78be872a656f3ef74b30d4e66f1ff091a343f75f096e64ab25b64d426862ed3f21dc54c6b6a8cb90b065c7b33b03e97acde7d58a2fa35664ec03ef1f82a30441a021ec008bee9444bbe50ec8ff457d32d06a63b9dc84fd82fa110a30dd849bf9f8cb4d3599b9aa09a76ad1b7c52bb972e5b16670670994ef7471f2d738ba9430664b7a1c259745ba8b2b9d98e695bad0b59e1fd989475a61570b2b677734c3f1887f9555b760811e20caba91eff59e9fb328561e12749c32f603bd50da5c4497393ccd560e88f367a664c5f2f9fe73107e2664a07a0f015877ce085f469dd24be1a20ce9544692e23094650a991e5bd7ab7d3b575d5ef71549fa442fe75a79a6c9f598eb1396e9332878c73f8af9e8f9f0cc11a4b42245acbb421646d6181c8f7f602298042a37d8b57520a1d68d6e3d473d5f1897e05db677c7ff6e260048255fdbe35fae42c791ea57ac0f2334e6ab5c650f59f3b27b1af30347314510a29fe19e20ac6e8eeb1e84deb687d2dc3d5cf4b03dbe35d165e
<<< 0000

new record
>>> 47 0300 (=parent record (storage)) 0500 (=type) 0300 (=storage id) 4c00 (=size) 030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< 0000 0500 <-- new record id

commit/flush?
>>> 1a
<<< 0000

>>> 0602000001648445315dac4d9c91edfb3c327ec18aee87a1fd5e0993fe74b56ee9a70f0eb4d65bfc877060728ad26e695be98899ef76b852162cc5e6ccded51e5a26e7e345c4a8e83aafa2e10fa4cc78f0f34575b0565089b4c78ce1ac7fe3744f4721aa73209fa4a8699e7161bfd7ee58dee33f1af15ba3b9ce9a469c5c82eda2b2a2f01658ee14118304e865bc2ad415bec9f06757bb3f2263bd0349a3c089380b72a30edf8db01db75586c60ddc9e7bedc8cf9006fcc6825b0ec9dc8782b95f53325bfb6a6945644f2803a4c7fd35574d8b7b089102fb072dfa883049f9484a789ff763a029f78adfceac92db195573c65986e38aec2135b5da3c0797939154135be5227515602c0148dbcb8c8a3760dad71f877471244cf1053a3cc4bc73c437589a1a47e08c260ea40d3259138e754a556a23e09bf926ad90ff36096c27c460ebdd28f20f31e9f42a192526d79b94e7f2c36b66db69946d93edf8fbd516e3ae59a0b81400c39f6bc1feb209924bc04703fd36ab53dd5658b2dd91633823917c37e944e740409c5fd66974ed42b73d5d7db519c7037b1ed32e471750da95299463cb070c80cea4a03bf20351716ee14423f84670c53ef7b998c179b84ae91cff6ca6b33a372e9947eebc873c6a98c6bcda68e5278b6f799a468bd1a33ae07bf717fbfc20f4d019f0fb25a5d6cb75a97fbd9b8490e6204d272d93f62ad393307cad3e24d292040e61fce6f1104c42dc4260de15f42971bbab18064b5dd6ceb12a32d9d25614d9326048052bc178b5a0aed3f350cbbec021c4b1ac6ed383f7f4eca0e475cf56caefc3edd3cde6526401936cc095b2df8e0008b2d9bd78c82af0a1ec0a71f047dd06b4ce6e91886607c55536f0d8712eae4ccb890008ccc27f2d6f6cb9b9bb88ec205019ec722160ffb1c65ca3177cff09c4bdae8c40be5bf91488a600ed199d0aad40510afe580802c56c0241a8b2a836800e8a0d07ae37176934252f92fc0e501aee29e6c3567e37b3e1992ff00b561fd1b3ae37caecc3a1fea7720b0806d3b39cf8a3fb46087b43775b9e473e65cb18af1c9d87a5140a5edf8b7843524910d63179c436b6a806d100eb066db889768f7da603631d75a6d79e3d0eb1fe9ba55401b828d4a367f695f3922b982be10fdb1f139a0b1438abc911db5da00ed464d80e3086d368dd131985a21610cd485740599afa772b5dc44d1906ea4c13b8e10b8db896fb81b706038a3328cd07aeb049e6ec92ecd30044c54eb171e9cf7a0034cd24614616048491f576826af5ca6afe4bc01f86dc01c2ea25efb32bc9b1c8d56cc7d4d86adf8f1f3bb6a649f98bae686ef93524721c618fad85a8125a8ac7d72bfeb7de9f590e8f43535e59259a7a1d13a12a1af91c8ba0dd45ddad02e5b86224fc00dcbc143b0e1d2da638d6798fcc340bda8f1e3abf21cadb2161c4c4be7001371dc56f0d112b42b113288effea6cab8c4b610f73037643de21f433774d9fb28cfd213a62dcafab8b662b57e77239dc2fb69f026fcb773f09129c8db04b82dce68734516ffcb938d43deeeedaa02cc08d7d06f34ec55ba4b224d3270265001df114b946d4238d51cfbfb84cf715b745ec918259c1165ee12ab82b4373eaa2b0c7e68da3eb869ff033d5953800012bb006d1cf17dcbbe2fb2e129614351c000cab8ccc7c389df33dbe504a0c1df37868b839ef84a6c04072d69fc86633055b2569c9c04f1994758987fc7063b97853c727809185a25cd69bfebf6a4367760fd21e7942b997bb2b7098dbec715769d13413c1c93185409e54a2c9a97daf63114c71348f19549fb3a8551afbbb7476842f7045a0ec8e6d97fb4bb6de76090687ab4e9991a31e7625ba7088a3263797be4787db02573b72100b3ba117e8897b939548715bcfa11d98861b60fa2a4759630b47cbbf329fbc675c4cfc2f963cc9ba72cbe6713aff1851869917ba0b761f6532d1dee95331c4c621bb0513e993f7e6dda6da1e3076829b24093c8338c125aa2f5a0730f9e5631f7a9594c13025fde9bb4f2431540a1c743c7fc55fc8909d85847fe71af8a68d2981b0eee84a308e0160fc4226aa679ca9b35d0aacae8240aabd5b217c5e66ac4795596f8742acb9869c3f52a96b1d946ff72f403ba491c1a0e4be778efab9d61a250562d705c2b459fc3a420143daf93552264bb8c7caa64143697961fab1b6af9e852d43a94736e1e75e4b9a7c2bee73598360c7e4c648e47ba9400dbe22b3eea6d9ab87fe677b3624257f81d26b87536a642a7840bdccd8fce05c23891a4fa4ce2156fba2856313653207bf225b8114005432824d16a93473deb81721c77196afd80cf723e8cdea81aaed19f55a09a8986f2950c49f4eebfb142d5e4815632d93ccb0106c156b47efca25dc3d7f31eb9b2dee0d2d83a51cbe5d1270222920f2c87e5acc884c11b0df7a7e1bb49b06fa4f936964d3f2782fa46eec3e430815f82ab0fb5eb82377277f8fe3ae5b33732d7d76ba3de284c66fba372f04f9ad6a39fa669a00583313d51c8e6b1eb960bf1e82ae8e0504b2d3035b371d5ecf638c1cc0c1dd67eff286fc9ee0950da53f339a85fbbcbacf61fcdadee8cdba0950d23ec71e2239ae7ab5be1bf56364897af990428822d23deed81fbbe622420234ded92b8fc3073bfa0a9677cd9e24b9f81278c50584bdc880fa2cd5c5c4b03bd78be872a656f3ef74b30d4e66f1ff091a343f75f096e64ab25b64d426862ed3f21dc54c6b6a8cb90b065c7b33b03e97acde7d58a2fa35664ec03ef1f82a30441a021ec008bee9444bbe50ec8ff457d32d06a63b9dc84fd82fa110a30dd849bf9f8cb4d3599b9aa09a76ad1b7c52bb972e5b16670670994ef7471f2d738ba9430664b7a1c259745ba8b2b9d98e695bad0b59e1fd989475a61570b2b677734c3f1887f9555b760811e20caba91eff59e9fb328561e12749c32f603bd50da5c4497393ccd560e88f367a664c5f2f9fe73107e2664a07a0f015877ce085f469dd24be1a20ce9544692e23094650a991e5bd7ab7d3b575d5ef71549fa442fe75a79a6c9f598eb1396e9332878c73f8af9e8f9f0cc11a4b42245acbb421646d6181c8f7f602298042a37d8b57520a1d68d6e3d473d5f1897e05db677c7ff6e260048255fdbe35fae42c791ea57ac0f2334e6ab5c650f59f3b27b1af30347314510a29fe19e20ac6e8eeb1e84deb687d2dc3d5cf4b03dbe35d165e
<<< 0000

create a finger record
>>> 47 0500 (=parent record (user)) 0b00 (=type) 0300 (=storage id) e80e (=record size) 
data:
f700 0300 c00e= 2000 0100 980e=template_sz
template=0000600e0000000005e31293ac59d01f06ff812......
0200 2000 
c4e991d8727e922415ce736a2fa119d14011be0fbca8c93849fb361d38a06e9e
0000000000000000000000000000000000000000000000000000000000000000 (e80e bytes - template)
<<< 0000 0600 <-- new record id

>>> 1a
<<< 0000

CeivMode::SetPayloadData:
>>> 45
<<< 00000100000000000000000003000015000000eb0200040001000300

search user by key and the storage id
>>> 4a000003004c00030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< 0000 0500 0100 0000 4c00
    0600 f700 0300 880e
    030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

check if record exists
>>> 46 0600
<<< 0000 0600 0600 0300 180f 0000 0000

>>> 0602000001648445315dac4d9c91edfb3c327ec18aee87a1fd5e0993fe74b56ee9a70f0eb4d65bfc877060728ad26e695be98899ef76b852162cc5e6ccded51e5a26e7e345c4a8e83aafa2e10fa4cc78f0f34575b0565089b4c78ce1ac7fe3744f4721aa73209fa4a8699e7161bfd7ee58dee33f1af15ba3b9ce9a469c5c82eda2b2a2f01658ee14118304e865bc2ad415bec9f06757bb3f2263bd0349a3c089380b72a30edf8db01db75586c60ddc9e7bedc8cf9006fcc6825b0ec9dc8782b95f53325bfb6a6945644f2803a4c7fd35574d8b7b089102fb072dfa883049f9484a789ff763a029f78adfceac92db195573c65986e38aec2135b5da3c0797939154135be5227515602c0148dbcb8c8a3760dad71f877471244cf1053a3cc4bc73c437589a1a47e08c260ea40d3259138e754a556a23e09bf926ad90ff36096c27c460ebdd28f20f31e9f42a192526d79b94e7f2c36b66db69946d93edf8fbd516e3ae59a0b81400c39f6bc1feb209924bc04703fd36ab53dd5658b2dd91633823917c37e944e740409c5fd66974ed42b73d5d7db519c7037b1ed32e471750da95299463cb070c80cea4a03bf20351716ee14423f84670c53ef7b998c179b84ae91cff6ca6b33a372e9947eebc873c6a98c6bcda68e5278b6f799a468bd1a33ae07bf717fbfc20f4d019f0fb25a5d6cb75a97fbd9b8490e6204d272d93f62ad393307cad3e24d292040e61fce6f1104c42dc4260de15f42971bbab18064b5dd6ceb12a32d9d25614d9326048052bc178b5a0aed3f350cbbec021c4b1ac6ed383f7f4eca0e475cf56caefc3edd3cde6526401936cc095b2df8e0008b2d9bd78c82af0a1ec0a71f047dd06b4ce6e91886607c55536f0d8712eae4ccb890008ccc27f2d6f6cb9b9bb88ec205019ec722160ffb1c65ca3177cff09c4bdae8c40be5bf91488a600ed199d0aad40510afe580802c56c0241a8b2a836800e8a0d07ae37176934252f92fc0e501aee29e6c3567e37b3e1992ff00b561fd1b3ae37caecc3a1fea7720b0806d3b39cf8a3fb46087b43775b9e473e65cb18af1c9d87a5140a5edf8b7843524910d63179c436b6a806d100eb066db889768f7da603631d75a6d79e3d0eb1fe9ba55401b828d4a367f695f3922b982be10fdb1f139a0b1438abc911db5da00ed464d80e3086d368dd131985a21610cd485740599afa772b5dc44d1906ea4c13b8e10b8db896fb81b706038a3328cd07aeb049e6ec92ecd30044c54eb171e9cf7a0034cd24614616048491f576826af5ca6afe4bc01f86dc01c2ea25efb32bc9b1c8d56cc7d4d86adf8f1f3bb6a649f98bae686ef93524721c618fad85a8125a8ac7d72bfeb7de9f590e8f43535e59259a7a1d13a12a1af91c8ba0dd45ddad02e5b86224fc00dcbc143b0e1d2da638d6798fcc340bda8f1e3abf21cadb2161c4c4be7001371dc56f0d112b42b113288effea6cab8c4b610f73037643de21f433774d9fb28cfd213a62dcafab8b662b57e77239dc2fb69f026fcb773f09129c8db04b82dce68734516ffcb938d43deeeedaa02cc08d7d06f34ec55ba4b224d3270265001df114b946d4238d51cfbfb84cf715b745ec918259c1165ee12ab82b4373eaa2b0c7e68da3eb869ff033d5953800012bb006d1cf17dcbbe2fb2e129614351c000cab8ccc7c389df33dbe504a0c1df37868b839ef84a6c04072d69fc86633055b2569c9c04f1994758987fc7063b97853c727809185a25cd69bfebf6a4367760fd21e7942b997bb2b7098dbec715769d13413c1c93185409e54a2c9a97daf63114c71348f19549fb3a8551afbbb7476842f7045a0ec8e6d97fb4bb6de76090687ab4e9991a31e7625ba7088a3263797be4787db02573b72100b3ba117e8897b939548715bcfa11d98861b60fa2a4759630b47cbbf329fbc675c4cfc2f963cc9ba72cbe6713aff1851869917ba0b761f6532d1dee95331c4c621bb0513e993f7e6dda6da1e3076829b24093c8338c125aa2f5a0730f9e5631f7a9594c13025fde9bb4f2431540a1c743c7fc55fc8909d85847fe71af8a68d2981b0eee84a308e0160fc4226aa679ca9b35d0aacae8240aabd5b217c5e66ac4795596f8742acb9869c3f52a96b1d946ff72f403ba491c1a0e4be778efab9d61a250562d705c2b459fc3a420143daf93552264bb8c7caa64143697961fab1b6af9e852d43a94736e1e75e4b9a7c2bee73598360c7e4c648e47ba9400dbe22b3eea6d9ab87fe677b3624257f81d26b87536a642a7840bdccd8fce05c23891a4fa4ce2156fba2856313653207bf225b8114005432824d16a93473deb81721c77196afd80cf723e8cdea81aaed19f55a09a8986f2950c49f4eebfb142d5e4815632d93ccb0106c156b47efca25dc3d7f31eb9b2dee0d2d83a51cbe5d1270222920f2c87e5acc884c11b0df7a7e1bb49b06fa4f936964d3f2782fa46eec3e430815f82ab0fb5eb82377277f8fe3ae5b33732d7d76ba3de284c66fba372f04f9ad6a39fa669a00583313d51c8e6b1eb960bf1e82ae8e0504b2d3035b371d5ecf638c1cc0c1dd67eff286fc9ee0950da53f339a85fbbcbacf61fcdadee8cdba0950d23ec71e2239ae7ab5be1bf56364897af990428822d23deed81fbbe622420234ded92b8fc3073bfa0a9677cd9e24b9f81278c50584bdc880fa2cd5c5c4b03bd78be872a656f3ef74b30d4e66f1ff091a343f75f096e64ab25b64d426862ed3f21dc54c6b6a8cb90b065c7b33b03e97acde7d58a2fa35664ec03ef1f82a30441a021ec008bee9444bbe50ec8ff457d32d06a63b9dc84fd82fa110a30dd849bf9f8cb4d3599b9aa09a76ad1b7c52bb972e5b16670670994ef7471f2d738ba9430664b7a1c259745ba8b2b9d98e695bad0b59e1fd989475a61570b2b677734c3f1887f9555b760811e20caba91eff59e9fb328561e12749c32f603bd50da5c4497393ccd560e88f367a664c5f2f9fe73107e2664a07a0f015877ce085f469dd24be1a20ce9544692e23094650a991e5bd7ab7d3b575d5ef71549fa442fe75a79a6c9f598eb1396e9332878c73f8af9e8f9f0cc11a4b42245acbb421646d6181c8f7f602298042a37d8b57520a1d68d6e3d473d5f1897e05db677c7ff6e260048255fdbe35fae42c791ea57ac0f2334e6ab5c650f59f3b27b1af30347314510a29fe19e20ac6e8eeb1e84deb687d2dc3d5cf4b03dbe35d165e
<<< 0000

new record
>>> 47 0600 (=parent record) 0800 (=type) 0300 (=storage id) 0c00 (=record size) 0001 0800 0000000000000000 (=payload 8 dup(0))
<<< 0000 0700 (new record id)

>>> 1a
<<< 0000
CeivMode::SetPayloadData - end

CEocMocEIV::EnrollmentCommit - done

CLedImpl::glow:
>>> 39f4010000f401000001ff002000000000ffff0000000000000000000000000020000000000000000000000000f401000000ff0020000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< 0000
CLedImpl::glow - end

CeivMode::UpdateTemplateListStorageOnFlash:
CeivMode::GetEnrolledUserList:
>>> 4b00000b0053746757696e64736f7200
<<< 0000030001000b00000005004c0053746757696e64736f7200

>>> 4b03000000
<<< 0000030001000b00000005004c0053746757696e64736f7200

>>> 4a050003004c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< 00000500010000004c000600f7000300880e030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

CeivMode::GetEnrolledUserList - end

CeivMode::GetEnrolledUserFingersStorageOnFlash:
>>> 4b00000b0053746757696e64736f7200
<<< 0000030001000b00000005004c0053746757696e64736f7200

>>> 4a000003004c00030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< 00000500010000004c000600f7000300880e030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

>>> 4b00000b0053746757696e64736f7200
<<< 0000030001000b00000005004c0053746757696e64736f7200

>>> 4a000003004c00030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000
<<< 00000500010000004c000600f7000300880e030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

CeivMode::GetEnrolledUserFingersStorageOnFlash - end
CeivMode::UpdateTemplateListStorageOnFlash - end

---------------------------------

6 fingers:
00000500060000004c00 
    0600f7000300980c 
    0800f5000300580c 
    0a00f6000300780f 
    0c00f8000300f810 
    0e00f9000300c810 
    1000fa000300580a
    030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

------------------------------------------------
3 users:
get storage by key:
>>> 4b 0000 0b00 53746757696e64736f7200 (0b bytes "StgWindsor\x00")
<<< 0000 0300 (=this record id) 0300 (=user count) 0b00 (=tag size) 0000
      0500 (=record id) 4c00 (key size)
      1200 (=record id) 4c00 (key size)
      1500 (=record id) 4c00 (key size)
      53746757696e64736f7200 (= "StgWindsor\x00")

get storage by id:
>>> 4b 0300 0000
<<< 0000 0300 0300 0b00 0000 
      0500 4c00
      1200 4c00
      1500 4c00
      53746757696e64736f7200

get user by id
>>> 4a 0500 (=record id) 0300 (=storage id) 4c00 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (4c dup(00))
<<< 0000 0500 (=this record id) 0600 (=record count) 0000 4c00 (key size)
      0600 (=record id) f700 (subtype (which finger)) 0300 980c
      0800 f500 0300 580c
      0a00 f600 0300 780f
      0c00 f800 0300 f810 <-- same finger, different users
      0e00 f900 0300 c810
      1000 fa00 0300 580a
      030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (4c bytes, key = user identity)

>>> 4a 1200 0300 4c00 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (4c dup(00))
<<< 0000 1200 0100 0000 4c00
      1300 f500 0300 780e
      030000001c000000010500000000000515000000c5698517bcff12e72496b762ed03000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (4c bytes, key = user identity)

>>> 4a 1500 0300 4c00 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 (4c dup(00))
<<< 0000 1500 0100 0000 4c00
      1600 f500 0300 f810 <-- same finger, different users
      030000001c000000010500000000000515000000c5698517bcff12e72496b762ed04000000000000000000000000000000000000000000000000000000000000000000000000000000000000

-------------------------------

>>> 480500
<<< 0000

-------------------
Experiments

------------- experiments with 46 --------
(get children)
>>> 46 0300
<<< 0000 0300 0400 0300 1b00 04000000 
    0400 0800 
    0500 0500
    1200 0500 
    1500 0500

>>> 46 0400
<<< 0000 0400 0800 0300 c800 00000000

>>> 46 0500
<<< 0000 0500 0500 0300 5c00 06000000
    0600 0600
    0800 0600
    0a00 0600
    0c00 0600
    0e00 0600
    1000 0600

>>> 46 0600
<<< 0000 0600 0600 0300 280d 01000000
    0700 0800

>>> 46 0100
<<< 0000 0100 0100 0000 0001 02000000
    0200 0200
    0300 0400

>>> 46 0200
<<< 0000 0200 0200 0000 1000 00000000


------- experiments with 49 ------------------------
(get data)
>>> 49 0300
<<< 0000 0300 (=this record id) 0400 (=type) 0300 (=sorage id) 0b000000 (=size) 53746757696e64736f7200 ('StgWindsor\x00' (0b bytes))

>>> 49 0800
<<< 0000 0800 (=this record id) 0600 (=type) 0300 (=sorage id) 600c0000 (=size) f5000300580c00000100300c4d56575430000100ffffffff070000001000100070018001e0016003300190040002900680011008700180098002000000000c000700000000000000000000000010680100e86301c82ae3735cc0413709a571b0ea14559254cbac2acaec083e52ca2c92caf1f07c....

>>> 49 0200
<<< b604 <-- hmmmm

------- experiments with 4a ------------------------
(get user info)

>>> 4a 0500 0300 0000
<<< 00000500060000004c000600f7000300980c0800f5000300580c0a00f6000300780f0c00f8000300f8100e00f9000300c8101000fa000300580a030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

>>> 4a 0500 0100 0000
>>> 00000500060000004c000600f7000300980c0800f5000300580c0a00f6000300780f0c00f8000300f8100e00f9000300c8101000fa000300580a030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

>>> 4a 0500 0000 0000
>>> 00000500060000004c000600f7000300980c0800f5000300580c0a00f6000300780f0c00f8000300f8100e00f9000300c8101000fa000300580a030000001c000000010500000000000515000000c5698517bcff12e72496b762ec03000000000000000000000000000000000000000000000000000000000000000000000000000000000000

>>> 4a 0300 0000 0000
<<< b304

Conclusion: 4a is a command tailored to work with users


------- experiments with 4b ------------------------

tl;dw - only works with storage records


---------------------------------

>>> 40 01 01 0000 00000000 00100000 <-- read 0x1000 bytes from data (cert) flash at 0x0000 addrss (part of TLS establishment)

>>> 40 06 01 0000 00000000 44000000 
>>> 40 06 01 0000 c8550000 44000000 <-- read from ??? 0x44 bytes at 0x44c8
>>> 40 06 01 0000 00000000 c8550000



41 01 0100 0000000000 00100000 00000100* <-- upload data flash block

41 06 0100 0000000000001000000* <-- upload calibration data

41 02 0100 0000f00200 00100000* <-- upload code flash block
41 02 0100 0000000300 00100000*
41 02 0100 0000100300 a0090000*

42 02 000001* <-- upload firmware signature (256 bytes)

